<div id="@($"{FileMetaDataExtensions.GetFolderIdForJS(Folder.Item.Id)}Div")" class="folder-item @(IsSelected ? "selected" : "")" >
        <div class="grid-item" style="cursor: pointer; @IndentStyleCss" @onclick="() => SelectFolderEmit()">
            <i class="far fa-folder"></i>
        </div>
        <div class="grid-item" @onclick="() => SelectFolderEmit()" style="cursor: pointer;">
            <div class="textcontent">
                @Folder.Item.Name
            </div>
        </div>
        <div class="grid-item">
            @if (Folder.HasChildren)
            {
                <i class="@ExpandImageClass" @onclick="() => ToggleExpanded()" @onclick:stopPropagation="true"></i>
            }
        </div>
    </div>

    @if (Folder.HasChildren & Folder.Expanded)
    {
        <div id="@($"{FileMetaDataExtensions.GetFolderIdForJS(Folder.Item.Id)}Content")" class="folder-list nested">
            @foreach (var childFolder in Folder.Children)
            {
                <FolderView Folder="childFolder" SelectedFolder="SelectedFolder" SelectFolder="SelectFolder"/>
            }
        </div>
    }

@code
{
    [Parameter]
    public Action<Folder> SelectFolder { get; set; }

    [Parameter]
    public Folder SelectedFolder { get; set; }

    [Parameter]
    public ExpandableItem<Folder> Folder { get; set; }

    public bool IsSelected
    {
        get
        {
            return SelectedFolder != null && SelectedFolder.Equals(Folder.Item);
        }
    }

    private string ExpandImageClass
    {
        get
        {
            return Folder.Expanded ? "fas fa-chevron-down" : "fas fa-chevron-right";
        }
    }

    private string IndentStyleCss
    {
        get
        {
            if (Folder.Level > 0)
            {
                return $"padding-inline-start: {Folder.Level * 40}px;";
            }

            return "";
        }
    }
    private void ToggleExpanded()
    {
        Folder.Expanded = !Folder.Expanded;
        StateHasChanged();
    }

    private void SelectFolderEmit()
    {
        SelectFolder?.Invoke(Folder.Item);
        StateHasChanged();
    }
}
