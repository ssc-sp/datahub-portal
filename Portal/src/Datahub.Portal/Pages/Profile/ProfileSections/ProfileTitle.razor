@using MudBlazor.Utilities
<MudStack Row>
    @if (IsCurrentUser)
    {
        <MudTooltip Placement="Placement.Bottom" Arrow Text="@Localizer["Change your profile picture"]">
            <MudLink OnClick="OpenProfilePictureDialog">
                <MudBadge Overlap Origin="Origin.BottomRight" Icon="@Icons.Material.Filled.Edit">
                    <ProfilePictureAvatar DisplayName="@User.DisplayName[..1]" ProfilePictureSrc="@_profilePictureSrc"/>
                </MudBadge>
            </MudLink>
        </MudTooltip>
    }
    else
    {
        <ProfilePictureAvatar DisplayName="@User.DisplayName[..1]" ProfilePictureSrc="@_profilePictureSrc"/>
    }
    <MudStack Spacing="0">
        <MudText Typo="Typo.h1">
            <b>@User.DisplayName</b>
        </MudText>
        <MudText Typo="Typo.caption" Class="ml-2">@User.Mail</MudText>
    </MudStack>
</MudStack>

@code {
    
    [Parameter]
    public GraphUser User { get; set; }
    [Parameter]
    public bool IsCurrentUser { get; set; }
    
    private string _profilePictureSrc;

    
    
    private async Task OpenProfilePictureDialog()
    {
        // var parameters = new DialogParameters
        // {
        //     {"User", User}
        // };
        // var options = new DialogOptions
        // {
        //     MaxWidth = MaxWidth.Medium,
        //     FullWidth = true,
        //     CloseButton = true,
        //     DisableBackdropClick = true,
        //     DisableEscapeKeyDown = true,
        //     Position = DialogPosition.Center
        // };
        // var dialog = DialogService.Show<ProfilePictureDialog>("Profile Picture", parameters, options);
        // var result = await dialog.Result;
        // if (!result.Cancelled)
        // {
        //     _profilePictureSrc = result.Data.ToString();
        // }
        return ;
    }
    
    
    
    protected override void OnInitialized()
    {
        base.OnInitialized();

        //TODO: Get profile picture from User table
    }
}