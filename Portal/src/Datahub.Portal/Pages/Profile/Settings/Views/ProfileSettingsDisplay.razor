@using Datahub.Portal.Components.User

@inject DatahubPortalConfiguration _datahubPortalConfiguration
@inject IDialogService _dialogService

<MudStack Spacing="8">
    <MudStack>
        <MudText Typo="Typo.h4">@Localizer["Public Profile"]</MudText>
        <MudDivider/>
    </MudStack>
    <MudStack>
        <MudText Typo="Typo.body1">
            <strong>
                @Localizer["Profile Picture"]
            </strong>
        </MudText>
        <MudText Typo="Typo.body2">@Localizer["Your profile picture will be displayed beside your name around DataHub. You can change it at any time."]</MudText>
        <MudElement>
            <MudLink OnClick="OpenImageDialog">
                <MudTooltip Placement="Placement.Bottom" Arrow Text="@Localizer["Click to change your profile picture"]">
                    <MudBadge Overlap Origin="Origin.BottomRight" Icon="@Icons.Material.Filled.Edit">
                        <UserAvatar PortalUser="@ViewedUser"/>
                    </MudBadge>
                </MudTooltip>
            </MudLink>
        </MudElement>
    </MudStack>
    <MudStack>
        <MudText Typo="Typo.body1">
            <strong>
                @Localizer["Profile Background"]
            </strong>
        </MudText>
        <MudText Typo="Typo.body2">@Localizer["Your profile background will be displayed on your profile page. You can change it at any time."]</MudText>
        <MudElement>
            <MudLink OnClick="OpenImageDialog">
                <MudTooltip Placement="Placement.Bottom" Arrow Text="@Localizer["Click to change your background picture"]">
                    <MudBadge Overlap Origin="Origin.BottomRight" Icon="@Icons.Material.Filled.Edit">
                        <MudImage Src="@BackgroundUrl" Alt="@Localizer["Background thumbnail"]" Elevation="25" Class="rounded-lg"/>
                    </MudBadge>
                </MudTooltip>
            </MudLink>
        </MudElement>
    </MudStack>
    <MudDivider/>
    <MudStack>
        <MudText Typo="Typo.body1">
            <strong>
                @Localizer["Display Achievements"]
            </strong>
        </MudText>
        <MudText Typo="Typo.body2">@Localizer["You can choose whether to hide or display your achievements in the DataHub. You can change it at any time."]</MudText>
        <MudSwitch T="bool" Label="@Localizer["Show Achievements"]" Checked="@(!ViewedUser.HideAchievements)" Color="Color.Primary" UnCheckedColor="Color.Dark"/>
    </MudStack>
</MudStack>

@code {

    [Parameter]
    public PortalUser ViewedUser { get; set; }

    [Parameter]
    public EventCallback<PortalUser> ViewedUserChanged { get; set; }


    private string BackgroundUrl => $"{_datahubPortalConfiguration?.Achievements.StaticAssetsUrl}/achievements/thumbnails/{ViewedUser?.BackgroundImageUrl}.jpg";

    // display name
    // bio
    // pronouns
    // department

    // profile picture
    // profile background
    // hide achievements

    // location
    // timezone

    private async Task OpenImageDialog()
    {
        var options = new DialogOptions { CloseOnEscapeKey = true };
        var dialog = await _dialogService.ShowAsync<ChangePictureDialog>(Localizer["Change Picture"], options);
        var result = await dialog.Result;

        if (!result.Canceled)
        {
        }
    }

}