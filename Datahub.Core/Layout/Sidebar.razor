@using Datahub.Core.Data
@using Datahub.Core.Utils
@using Datahub.Portal.Services
@inject ServiceAuthManager ServiceAuthManager


<MudNavMenu>
    @foreach (var (href, icon, label) in GetLinks())
    {
        <MudNavLink Href="@href" Icon="@icon" Match="NavLinkMatch.Prefix">
            @Localizer[label]
        </MudNavLink>
    }
    @foreach (var (href, icon, label, roles) in GetAuthorizedLinks())
    {
        <AuthorizeView Roles="@string.Join(',', roles)">
            <MudNavLink Href="@href" Icon="@icon" Match="NavLinkMatch.Prefix">
                @Localizer[label]
            </MudNavLink>
        </AuthorizeView>
    }
</MudNavMenu>

@code {


    private List<(string Href, string Icon, string Label)> GetLinks()
    {
        return new List<(string, string, string)>()
        {
            ("/home", Icons.Filled.Home, "SIDEBAR.Home"),
    //("/data", Icon.STORAGE, "SIDEBAR.Storage"),
            ($"/{UrlPathSegment.PROJECTS}", Icons.Filled.Category, "SIDEBAR.DataProjects"),
            ("/resources", Icons.Filled.MenuBook, "SIDEBAR.Resources"),
            ("/tools", Icons.Filled.Construction, "SIDEBAR.Tools"),
    //("/datasets", Icon.DATASETS, "SIDEBAR.Datasets"),
    //("/powerbi", Icon.POWERBI, "SIDEBAR.PowerBI"),      
        };
    }

    private List<(string Href, string Icon, string Label, List<string> Roles)> GetAuthorizedLinks()
    {
        var projects = ServiceAuthManager.GetAdminProjectRoles();
        if (projects.Any())
        {
            return new List<(string, string, string, List<string>)>()
            {
                ("/administration", Icons.Filled.AdminPanelSettings, "SIDEBAR.Admin", projects),
            };
        }

        return new List<(string, string, string, List<string>)>();
    }

}